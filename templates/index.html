<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
    <title>Books</title>
    <!-- bootstrap 5 css -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl"
      crossorigin="anonymous"
    />
    <!-- BOX ICONS CSS-->
    <link
      href="https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css"
      rel="stylesheet"
    />
    <!-- FONTAWESOME CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"/>
    <!-- custom css -->
    <link rel="stylesheet" href="../static/sass/index.css" />
  </head>

  <body>
    <main>
    
    <!-- Side-Nav -->
    <div class="side-navbar active-nav d-flex justify-content-between flex-wrap flex-column" id="sidebar">
      <ul class="nav flex-column text-white w-100">
        <a href="#" class="nav-link h3 text-white my-2">
          CS50W PROJECT1</br>Books
        </a>
        <li href="#" class="nav-link">
        <i class="fa-solid fa-house"></i>
          <span class="mx-2">Home</span>
        </li>
        <li href="#" class="nav-link">
          <i class="fa-solid fa-search"></i>
          <span class="mx-2">Search a book</span>
        </li>
        <li href="#" class="nav-link">
        <i class="fa-solid fa-user"></i>
        <a href=""><span class="mx-2">Account</span></a> 
        </li>
      </ul>
      <ul class="nav flex-column text-white w-100">
        <li href="#" class="nav-link">
          <i class="fa-solid fa-sign-out"></i>
          <form method="POST" action="/logout">
            <button type="submit" class="btn btn-primary btn-logout">
                Cerrar Sesion
            </button>
        </form>
          </li>
      </ul>
    </div>

    <!-- Main Wrapper -->
    <div class="p-1 my-container active-cont">
      <!-- Top Nav -->
      <nav class="navbar top-navbar navbar-light bg-light px-5">
        <a class="btn border-0" id="menu-btn"><i class="bx bx-menu"></i></a>
      </nav>
      <!--End Top Nav -->
      {% if user_name %}
        <h3 class="bienvenido">Bienvenido, {{ user_name }}</h3>
      {% endif %}

<!-- Buscador -->
<form class="d-flex" action="/books" method="POST">
  <input class="form-control me-2" type="search" placeholder="Buscar por ISBN, Autor, Titulo o AÃ±o" aria-label="Buscar" required name="search_term">
  <button class="btn btn-outline-dark" type="submit">Buscar</button>
</form>
<!-- resultado -->
<div class="container my-5">
  {% if books %}
    {% for book in books %}
      <div class="row">
        <div class="col-md-3">
          <img src="{{ book.thumbnail }}" alt="Book Cover" class="img-fluid">
        </div>
        <div class="col-md-9">
          <h2 class="fw-bold mb-4">{{ book.title }}</h2>
          <div class="d-flex align-items-center mb-3">
            <span class="text-muted me-2">Author:</span>
            <span>{{ book.author }}</span>
          </div>
          <div class="d-flex align-items-center mb-3">
            <span class="text-muted me-2">ISBN:</span>
            <span>{{ book.isbn }}</span>
          </div>
          <div class="d-flex align-items-center mb-3">
            <span class="text-muted me-2">Year:</span>
            <span>{{ book.year }}</span>
          </div>
          <p class="lead mb-4">{{ book.description }}</p>
          {% if book.buy_link %}
            <a href="{{ book.buy_link }}" class="btn btn-primary">Buy on Google Books</a>
          {% endif %}
        </div>
      </div>
      <hr>
    {% endfor %}
      {% else %}
        <p>No books found.</p>
  {% endif %}
</div>
</div>

</main>

{% with messages = get_flashed_messages(with_categories=True) %}
{% if messages %}
    {% for category, message in messages %}
        {% if category == 'error' %}
            <script>
                Swal.fire({
                    position: 'center',
                    icon: 'error',
                    text: "{{message}}",
                    showConfirmButton: true,
                    timer: 5000
                })
            </script>
        {% else %}
            <script>
                Swal.fire({
                    position: 'center',
                    icon: 'success',
                    text: "{{message}}",
                    showConfirmButton: true,
                    timer: 5000
                })
            </script>
        {% endif %}
    {% endfor %}
{% endif %}
{% endwith %}
    



    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <!-- bootstrap js -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
      crossorigin="anonymous"
    ></script>
    <!-- custom js -->
    <script>
      var menu_btn = document.querySelector("#menu-btn");
      var sidebar = document.querySelector("#sidebar");
      var container = document.querySelector(".my-container");
      menu_btn.addEventListener("click", () => {
        sidebar.classList.toggle("active-nav");
        container.classList.toggle("active-cont");
      });
    </script>
  </body>
</html>
